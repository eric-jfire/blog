<div class="easyui-layout" data-options="fit:true">
    <div  class="pre-show" data-options="region:'east',title:'预览'" style="width:25%;padding:10px 10px;overflow-x:hidden">
        <div class="linxi_wrap">
            <div class="linxi_content" id="magezaine-commodity-list-preshow">
            </div>
            <p style="margin:0 auto;margin-top:80px;font-size:12px">
                &nbsp;&nbsp;&nbsp;备注： 手机浏览器上不会出现滚动条，会更加美观
            </p>
        </div>
    </div>
    <div data-options="region:'center',title:'查看',border:false">
        <div class="easyui-layout" data-options="fit:true">
            <div data-options="region:'north',title:'过滤条件',collapsible:true" style="height:32%">
                <p>
                    <span>内容 :</span>
                    <input id="commodity-list-query-content" class="easyui-textbox" type="text" name="content" />
                </p>
                <p>
                    <span>更新时间 :</span>
                    <input id="commodity-list-query-start" class="easyui-datebox" type="text" name="start" data-options="editable:false" />
                    <span>- </span>
                    <input id="commodity-list-query-end" class="easyui-datebox" type="text" name="end" data-options="editable:false" />
                </p>
                <p>
                    <span>状态 :</span>
                    <select id="commodity-list-query-state" class="easyui-combobox" name="state">
                        <option value="">全部</option>
                        <option value="true">上架</option>
                        <option value="false">下架</option>
                    </select>
                </p>
                <a href="javascript:void(0)" class="easyui-linkbutton" onclick="queryCommodity()" data-options="text:'查询'"></a>
                <a href="javascript:void(0)" class="easyui-linkbutton" onclick="resetCommodityQuery()" data-options="text:'清空'"></a>
            </div>
            <div data-options="region:'center',title:'列表'">
                <table id="commodity_edit_dg">
                </table>
            </div>
        </div>
    </div>
</div>
<script type="text/javascript">
    function queryCommodity()
    {
        var queryParams = $('#commodity_edit_dg').datagrid('options').queryParams;
        queryParams.content = $('#commodity-list-query-content').textbox('getValue');
        queryParams.state = $('#commodity-list-query-state').combobox('getValue');
        queryParams.start = $('#commodity-list-query-start').datebox('getValue');
        queryParams.end = $('#commodity-list-query-end').datebox('getValue');
        $("#commodity_edit_dg").datagrid('options').queryParams = queryParams;
        $("#commodity_edit_dg").datagrid('load');
    }
    
    function resetCommodityQuery()
    {
        $('#commodity-list-query-content').textbox('reset');
        $('#commodity-list-query-state').combobox('reset');
        $('#commodity-list-query-start').datebox('reset');
        $('#commodity-list-query-end').datebox('reset');
    }
    
    $(function()
    {
        $('#commodity_edit_dg').datagrid(
        {
            url: commodityListUrl,
            fit: true,
            checkOnSelect: false,
            selectOnCheck: false,
            singleSelect: true,
            pagination: true,
            idField: 'id',
            columns: [[
            {
                field: 'id',
                checkbox: true,
                width: 20
            }, 
            {
                field: 'name',
                title: '名称',
                width: 80
            }, 
            {
                field: 'price',
                title: '价格(元)',
                width: 120
            }, 
            {
                field: 'detail',
                title: '简要描述',
                width: 240
            }, 
            {
                field: 'state',
                title: '状态',
                width: 120,
                formatter: function(value)
                {
                    if (value) 
                    {
                        return "上架";
                    }
                    else 
                    {
                        return "下架";
                    }
                },
                styler: function(value, row, index)
                {
                    if (value == false) 
                    {
                        return 'background-color:#ffee00;color:red;';
                    }
                }
                
            }, 
            {
                field: 'createtime',
                title: '创建时间',
                width: 120
            }, 
            {
                field: 'updatetime',
                title: '更新时间',
                width: 120
            }]],
            toolbar: [
            {
                iconCls: 'icon-edit',
                text: '预览',
                handler: function()
                {
                    showCommodity('commodity_edit_dg', 'magezaine-commodity-list-preshow');
                }
            }, '-', 
            {
                iconCls: 'icon-edit',
                text: '编辑',
                handler: function()
                {
                    editCommodity();
                }
            }, '-', 
            {
                iconCls: 'icon-add',
                text: '增加',
                handler: function()
                {
                    addCommodity();
                }
            }, '-', 
            {
                iconCls: 'icon-remove',
                text: '删除',
                handler: function()
                {
                    deleteCommodity();
                }
            }, 
            {
                iconCls: 'icon-remove',
                text: '上架',
                handler: function()
                {
                    commodityStateChange(true);
                }
                
            }, 
            {
                iconCls: 'icon-remove',
                text: '下架',
                handler: function()
                {
                    commodityStateChange(false);
                }
            }]
        });
    });
</script>
